<?php
 defined("\102\x41\123\x45\120\101\x54\x48") or die("\x4e\x6f\40\x64\x69\162\x65\x63\164\x20\x73\x63\x72\151\160\x74\40\141\x63\143\x65\x73\x73\40\x61\x6c\154\157\x77\145\144"); class Order extends MY_Controller { public function __construct() { parent::__construct(); $this->load_global(); $this->load->model("\x6f\162\144\x65\x72\137\155\x6f\x64\x65\x6c", "\157\x72\144\145\162\137\155\x6f\x64\x65\154"); $this->load->helper("\163\x6d\163\x5f\x74\145\x6d\x70\154\x61\x74\x65\137\150\x65\x6c\x70\x65\x72"); } public function is_sms_enabled() { return is_sms_enabled(); } public function index() { $this->permission_check("\x70\157\163"); $data = $this->data; $data["\160\x61\x67\145\x5f\x74\x69\164\154\x65"] = "\x4f\x72\144\145\162"; $data["\162\x65\x73\x75\x6c\164"] = $this->get_hold_invoice_list(); $data["\x74\157\x74\x5f\143\x6f\x75\156\164"] = $this->get_hold_invoice_count(); $this->load->view("\157\x72\144\x65\162", $data); } public function newcustomer() { $this->form_validation->set_rules("\143\165\x73\x74\x6f\x6d\x65\x72\137\156\141\x6d\145", "\103\x75\x73\164\x6f\155\145\162\x20\116\141\x6d\x65", "\x74\x72\x69\x6d\x7c\x72\145\x71\x75\151\162\x65\x64"); if ($this->form_validation->run() == TRUE) { $this->load->model("\x63\x75\x73\164\157\x6d\x65\162\x73\137\x6d\157\144\145\x6c"); $result = $this->customers_model->verify_and_save(); $res = array(); $query = $this->db->query("\x73\145\x6c\145\143\x74\x20\x69\x64\54\143\x75\163\x74\x6f\155\145\162\x5f\x6e\141\155\145\x20\146\x72\157\x6d\x20\x64\x62\137\143\x75\163\164\x6f\155\x65\x72\x73\x20\x6f\x72\144\x65\162\x20\x62\x79\40\151\144\40\x64\145\163\x63\x20\x6c\x69\x6d\151\164\40\61"); $res["\x69\144"] = $query->row()->id; $res["\x63\165\x73\x74\157\x6d\145\162\137\156\141\x6d\x65"] = $query->row()->customer_name; $res["\162\145\163\165\x6c\164"] = $result; echo json_encode($res); } else { echo "\x50\x6c\145\x61\163\145\x20\106\x69\x6c\x6c\40\x43\157\x6d\x70\165\154\163\x6f\162\x79\50\x2a\40\x6d\141\162\x6b\x65\144\x29\x20\106\x69\x65\154\144\163\56"; } } public function get_details() { echo $this->order_model->get_details(); } public function receive_order() { echo $this->order_model->receive_order(); } public function pos_save_update() { $result = ''; if ($this->input->post("\x63\157\x6d\x6d\141\156\144") == "\x75\x70\144\141\x74\x65") { $result = $this->order_model->pos_save_update(); } else { $result = $this->order_model->pos_save_update(); $result = $result . "\x3c\74\x3c\43\x23\43\x3e\x3e\x3e" . $this->order_model->hold_invoice_list(); $q1 = $this->db->query("\123\105\114\105\103\124\40\x2a\40\x46\x52\x4f\115\x20\x64\x62\x5f\x68\157\154\x64"); $data["\x74\157\164\x5f\143\157\x75\156\x74"] = $q1->num_rows(); $result = $result . "\74\74\74\x23\x23\43\x3e\x3e\76" . $q1->num_rows(); } echo $result; die; } public function edit($sales_id) { $this->permission_check("\x73\141\154\145\163\x5f\x65\144\x69\164"); $data = $this->data; $data["\163\x61\154\x65\x73\137\x69\x64"] = $sales_id; $data["\160\141\147\x65\x5f\164\x69\x74\154\145"] = "\120\117\x53\x20\x55\160\x64\x61\164\145"; $data["\x72\x65\163\165\x6c\x74"] = $this->get_hold_invoice_list(); $data["\x74\157\x74\137\143\x6f\x75\x6e\164"] = $this->get_hold_invoice_count(); $data["\143\165\163\164\157\x6d\x65\162\x5f\151\x64"] = get_sales_details($sales_id)->customer_id; $this->load->view("\x70\x6f\x73", $data); } public function fetch_sales($sales_id) { $result = $this->order_model->edit_pos($sales_id); } public function hold_invoice() { echo $this->order_model->hold_list_save_update(); } public function hold_invoice_list() { $data = array(); $data["\162\x65\x73\x75\x6c\164"] = $this->get_hold_invoice_list(); $data["\164\x6f\x74\x5f\x63\x6f\165\156\x74"] = $this->get_hold_invoice_count(); echo json_encode($data); } public function get_hold_invoice_list() { $data = array(); $result = $this->order_model->hold_invoice_list(); return $result; } public function get_hold_invoice_count() { $q1 = $this->db->query("\123\x45\x4c\x45\x43\x54\40\52\x20\x46\122\x4f\115\40\x64\142\x5f\150\157\154\x64"); return $q1->num_rows(); } public function hold_invoice_delete($invoice_id) { $result = $this->order_model->hold_invoice_delete($invoice_id); echo trim($result); } public function hold_invoice_delete_by_table($invoice_id) { $result = $this->order_model->hold_invoice_delete_by_table($invoice_id); echo trim($result); } public function hold_invoice_edit() { echo $this->order_model->hold_invoice_edit(); } public function add_payment_row() { return $this->load->view("\x6d\157\x64\141\154\163\137\160\157\x73\x5f\x70\141\171\155\x65\156\164\x2f\155\x6f\x64\x61\154\x5f\x70\x61\171\155\x65\x6e\164\x73\x5f\155\x75\x6c\164\151\137\x73\165\x62"); } public function print_invoice_pos($sales_id) { if (!$this->permissions("\x73\x61\x6c\x65\163\137\x61\144\x64") && !$this->permissions("\163\x61\154\145\x73\137\x65\144\151\164")) { $this->show_access_denied_page(); } $data = $this->data; $data["\160\x61\147\145\x5f\164\x69\x74\x6c\145"] = $this->lang->line("\163\141\154\x65\x73\x5f\151\x6e\x76\157\x69\143\x65"); $data = array_merge($data, array("\x73\141\x6c\x65\x73\137\x69\144" => $sales_id)); $this->load->view("\x73\141\x6c\x2d\x69\156\x76\x6f\x69\x63\x65\x2d\160\157\163", $data); } public function print_bill_order($sales_id) { if (!$this->permissions("\x73\141\x6c\x65\163\x5f\x61\x64\x64") && !$this->permissions("\163\x61\154\x65\163\x5f\x65\x64\x69\164")) { $this->show_access_denied_page(); } $data = $this->data; $data["\x70\x61\147\x65\137\164\151\x74\x6c\x65"] = "\304\x90\341\xba\267\x74\x20\155\303\263\156"; $data = array_merge($data, array("\163\141\x6c\145\163\x5f\x69\144" => $sales_id)); $this->load->view("\x73\x61\154\55\142\x69\x6c\x6c\55\157\162\x64\x65\162", $data); } public function get_item_details() { echo $this->order_model->get_item_details($this->input->post("\151\164\145\155\x5f\x69\x64")); } public function print_qr($data = '') { $this->load->model("\121\x72\143\x6f\144\x65\137\x6d\157\x64\145\x6c", "\161\162"); return $this->qr->qr_image($data); die; $data = trim($data); $data = base64_decode(str_replace("\x2d", "\75", str_replace("\137", "\57", $data))); $options = new QROptions(array()); return !empty($data) ? "\x3c\151\155\x67\x20\163\x72\143\75\42" . (new QRCode($options))->render($data) . "\42\x20\141\x6c\x74\x3d\x22\121\122\x20\103\x6f\x64\x65\42\40\57\x3e" : ''; } }