<?php
 defined("\102\x41\x53\x45\120\101\x54\x48") or die("\116\157\x20\x64\x69\162\145\143\x74\40\x73\143\x72\151\160\164\40\141\x63\x63\x65\163\163\40\x61\x6c\154\x6f\x77\x65\x64"); use Mpdf\Mpdf; class Sales extends MY_Controller { public function __construct() { parent::__construct(); $this->load_global(); $this->load->model("\x73\x61\x6c\145\163\137\x6d\x6f\144\145\154", "\163\141\154\145\x73"); $this->load->helper("\x73\x6d\x73\x5f\164\145\155\160\x6c\141\x74\145\x5f\150\x65\x6c\x70\x65\162"); } public function is_sms_enabled() { return is_sms_enabled(); } public function index() { $this->permission_check("\163\x61\x6c\145\x73\x5f\166\151\x65\167"); $data = $this->data; $data["\x70\x61\x67\145\137\164\151\x74\x6c\x65"] = $this->lang->line("\163\x61\x6c\145\163\137\x6c\151\163\x74"); $this->load->view("\163\x61\154\x65\x73\55\154\x69\163\164", $data); } public function add() { $this->permission_check("\x73\141\x6c\x65\163\x5f\141\144\144"); $data = $this->data; $data["\x70\x61\x67\x65\137\x74\151\164\x6c\x65"] = $this->lang->line("\163\141\154\145\x73"); $this->load->view("\163\x61\x6c\x65\x73", $data); } public function sales_save_and_update() { $this->form_validation->set_rules("\163\x61\154\145\x73\137\x64\141\164\145", "\123\141\154\x65\x73\40\x44\x61\x74\145", "\x74\162\151\155\174\x72\145\x71\x75\x69\x72\x65\x64"); $this->form_validation->set_rules("\143\x75\163\164\157\x6d\x65\162\137\x69\144", "\103\165\x73\164\x6f\155\x65\x72\40\116\x61\155\x65", "\x74\x72\151\155\x7c\162\145\x71\165\151\x72\x65\x64"); if ($this->form_validation->run() == TRUE) { $result = $this->sales->verify_save_and_update(); echo $result; } else { echo "\120\154\145\x61\163\145\x20\106\x69\154\x6c\40\x43\157\x6d\x70\165\154\163\157\162\171\50\x2a\40\155\141\162\x6b\x65\x64\x29\x20\106\151\x65\x6c\144\x73\x2e"; } } public function update($id) { $this->permission_check("\x73\141\154\x65\x73\137\145\x64\x69\164"); $data = $this->data; $data = array_merge($data, array("\163\x61\x6c\x65\x73\x5f\x69\144" => $id)); $data["\x70\x61\147\x65\x5f\164\x69\164\154\145"] = $this->lang->line("\x73\141\154\145\x73"); $this->load->view("\x73\141\x6c\145\163", $data); } public function ajax_list() { $list = $this->sales->get_datatables(); $data = array(); $no = $_POST["\163\x74\x61\x72\164"]; foreach ($list as $sales) { $no++; $row = array(); $row[] = "\x3c\x69\x6e\x70\165\x74\40\164\171\160\145\75\x22\x63\150\x65\143\153\x62\157\170\42\x20\156\141\155\x65\x3d\42\x63\x68\145\x63\x6b\142\157\170\133\135\42\40\166\x61\x6c\x75\x65\75" . $sales->id . "\40\x63\154\x61\163\163\75\x22\143\x68\x65\143\x6b\142\157\170\x20\x63\157\x6c\165\155\156\137\x63\150\x65\x63\x6b\142\x6f\170\42\40\x3e"; $row[] = show_date($sales->sales_date); $info = !empty($sales->return_bit) ? "\12\74\163\x70\x61\156\40\143\x6c\x61\x73\x73\x3d\x27\x6c\x61\142\145\154\40\x6c\141\x62\145\154\x2d\x64\x61\x6e\x67\x65\162\47\x20\x73\164\171\154\145\x3d\x27\x63\x75\162\163\157\x72\x3a\x70\157\151\x6e\164\x65\162\47\76\74\151\40\x63\154\141\163\163\x3d\x27\x66\x61\x20\x66\x61\55\x66\167\40\x66\141\x2d\165\156\144\x6f\x27\76\x3c\57\x69\76\x52\x65\x74\x75\x72\156\40\x52\141\151\x73\145\x64\74\x2f\x73\160\141\x6e\76" : ''; $row[] = $sales->sales_code . $info; if ($sales->sale_step == 0) { $str = "\74\x73\160\x61\156\x20\x6f\x6e\143\154\151\x63\x6b\75\x27\x75\x70\144\x61\x74\145\137\x73\x74\x65\160\x28" . $sales->id . "\54\61\51\47\40\151\144\75\x27\x73\x70\x61\x6e\x5f" . $sales->id . "\47\x20\x20\143\x6c\141\163\163\75\x27\154\141\x62\x65\x6c\40\x6c\x61\142\145\154\55\144\x61\156\147\x65\x72\47\40\163\164\x79\154\145\x3d\x27\x63\x75\x72\x73\x6f\x72\x3a\160\x6f\x69\x6e\x74\145\162\x27\76\304\x90\303\243\x20\x6e\150\xe1\xba\xad\156\74\57\x73\160\141\x6e\x3e"; } else { if ($sales->sale_step == 1) { $str = "\74\163\160\x61\x6e\x20\x6f\156\x63\154\151\x63\153\75\47\165\160\144\141\x74\145\137\163\164\145\160\50" . $sales->id . "\54\62\x29\47\x20\x69\144\x3d\47\163\160\141\x6e\x5f" . $sales->id . "\47\40\x20\143\154\x61\x73\163\x3d\47\154\x61\x62\x65\154\x20\154\x61\x62\145\x6c\x2d\x77\141\162\x6e\x69\156\x67\x27\40\x73\x74\x79\154\145\x3d\47\x63\165\162\163\x6f\162\x3a\x70\157\x69\x6e\x74\x65\162\x27\76\304\x90\303\243\40\130\157\x6e\x67\x3c\57\163\x70\141\x6e\76"; } else { $str = "\74\163\160\x61\x6e\40\x6f\156\143\x6c\x69\x63\153\x3d\47\x75\160\144\141\x74\x65\x5f\x73\x74\x65\x70\x28" . $sales->id . "\54\x30\51\47\40\x69\144\x3d\x27\163\160\x61\x6e\137" . $sales->id . "\47\x20\x20\143\x6c\141\163\163\75\x27\154\141\142\145\154\x20\x6c\141\x62\145\154\x2d\x73\x75\143\x63\145\x73\163\47\x20\x73\164\171\154\145\75\47\143\165\x72\x73\157\x72\72\x70\x6f\x69\156\164\x65\162\x27\x3e\xc4\220\xc3\xa3\40\164\x72\xe1\272\xa3\x20\x68\xc3\xa0\156\147\74\x2f\163\x70\x61\x6e\76"; } } $row[] = $str; $row[] = $sales->sales_note; $row[] = $sales->schedule_time; $row[] = $sales->customer_name; $row[] = app_number_format($sales->grand_total); $row[] = app_number_format($sales->paid_amount); $row[] = app_number_format($sales->sales_due); $str = ''; if ($sales->payment_status == "\x55\156\x70\141\151\x64") { $str = "\74\163\160\x61\156\x20\x63\154\x61\163\x73\75\x27\x6c\141\142\x65\154\40\x6c\141\x62\145\x6c\x2d\x64\x61\x6e\147\145\162\47\40\163\164\171\154\145\x3d\x27\143\x75\162\x73\x6f\162\72\x70\157\151\156\x74\145\162\x27\76\x20\116\341\xbb\xa3\40\74\x2f\163\160\141\x6e\76"; } if ($sales->payment_status == "\x50\x61\x72\164\x69\141\x6c") { $str = "\x3c\163\x70\x61\x6e\x20\143\154\x61\x73\x73\x3d\x27\154\141\142\x65\x6c\x20\154\141\x62\145\x6c\55\167\x61\162\x6e\x69\156\147\47\40\163\x74\171\x6c\145\75\47\143\165\x72\x73\x6f\162\x3a\x70\157\151\x6e\x74\x65\x72\47\x3e\40\x4e\xe1\273\xa3\x20\x6d\341\xbb\x99\164\40\160\x68\xe1\xba\247\156\x20\74\x2f\163\160\141\x6e\x3e"; } if ($sales->payment_status == "\x50\141\151\x64") { $str = "\74\x73\160\141\156\40\143\154\x61\x73\163\x3d\47\x6c\x61\x62\x65\x6c\40\154\x61\142\x65\x6c\55\163\x75\x63\143\x65\x73\x73\x27\40\163\x74\x79\154\x65\75\x27\143\x75\162\x73\157\162\72\160\x6f\151\156\164\x65\x72\x27\x3e\40\xc4\x90\303\243\40\x74\x68\x61\x6e\x68\40\x74\x6f\xc3\241\156\x20\x3c\57\x73\160\141\x6e\x3e"; } $row[] = $str; if ($sales->pos == 1) { $str1 = "\x70\x6f\x73\x2f\x65\x64\x69\164\57"; } else { $str1 = "\163\x61\154\145\x73\57\x75\x70\x64\x61\164\x65\x2f"; } $str2 = "\74\x64\151\166\x20\143\x6c\141\163\163\75\x22\142\164\156\55\x67\x72\x6f\165\160\42\40\164\x69\164\154\x65\75\x22\126\x69\145\x77\x20\101\x63\143\157\x75\x6e\164\42\x3e\xa\x9\x9\11\x9\x9\11\x9\x9\x9\x9\74\141\x20\x63\154\141\x73\163\75\42\142\x74\x6e\40\x62\164\156\55\160\x72\151\155\141\162\x79\40\142\x74\x6e\55\157\x20\144\x72\x6f\160\x64\x6f\167\156\55\164\157\x67\x67\154\x65\42\40\144\141\164\141\55\164\157\x67\147\x6c\x65\75\42\x64\162\157\x70\144\x6f\167\156\x22\x20\x68\x72\145\x66\75\42\x23\x22\x3e\xa\x9\x9\11\11\11\11\11\x9\x9\11\11\101\143\x74\151\x6f\156\x20\x3c\163\x70\x61\x6e\40\143\154\x61\x73\x73\75\x22\x63\141\x72\x65\164\42\76\74\57\x73\160\141\x6e\76\12\x9\11\11\x9\11\x9\11\11\11\x9\74\x2f\141\76\xa\x9\11\x9\x9\x9\x9\11\x9\11\x9\74\x75\x6c\x20\x72\157\154\145\x3d\42\x6d\145\156\x75\42\x20\x63\x6c\141\x73\x73\75\x22\144\162\157\160\144\157\167\156\55\155\x65\156\x75\40\x64\x72\157\x70\144\157\167\156\55\154\x69\147\150\x74\x20\160\165\154\x6c\55\162\151\147\150\x74\x22\76"; if ($this->permissions("\x73\x61\x6c\x65\163\x5f\166\x69\145\167")) { $str2 .= "\74\154\151\76\xa\x9\x9\x9\x9\11\11\11\11\11\x9\11\x3c\x61\40\164\x69\x74\154\145\x3d\42\120\x61\x79\42\x20\143\154\x61\x73\x73\75\x22\160\x6f\x69\156\164\x65\162\x22\x20\x6f\156\x63\x6c\x69\143\x6b\75\x22\166\151\x65\x77\137\x73\141\x6c\x65\163\x28" . $sales->id . "\x29\x22\40\x3e\xa\11\x9\x9\11\11\x9\11\x9\11\x9\x9\x9\x9\74\151\40\143\154\141\163\163\x3d\42\146\x61\40\146\141\x2d\x66\x77\x20\146\141\x2d\145\171\x65\x20\164\145\170\x74\55\x62\x6c\x75\x65\x22\x3e\74\x2f\151\76\130\145\x6d\x20\156\150\141\156\150\40\150\303\263\141\x20\304\221\306\xa1\x6e\12\x9\11\x9\x9\11\x9\11\11\x9\11\11\11\x3c\57\141\76\12\11\11\11\x9\x9\x9\x9\11\x9\x9\x9\74\x2f\x6c\151\x3e"; } if ($this->permissions("\163\x61\154\x65\163\x5f\x76\x69\145\x77")) { $str2 .= "\74\154\151\76\12\11\11\11\x9\11\11\11\11\11\11\11\11\x3c\x61\x20\164\151\x74\x6c\145\75\x22\x56\x69\x65\167\x20\111\x6e\166\157\x69\x63\145\x22\40\150\162\145\146\75\x22\x73\x61\154\x65\163\57\151\156\x76\157\x69\143\x65\57" . $sales->id . "\42\x20\76\12\11\x9\11\x9\11\x9\11\11\x9\11\11\11\11\x3c\151\40\143\x6c\x61\x73\x73\75\x22\x66\x61\x20\x66\x61\x2d\x66\x77\x20\146\x61\x2d\145\x79\145\40\164\x65\170\164\55\x62\x6c\165\x65\42\76\x3c\57\151\76\130\x65\155\40\x6c\341\272\xa1\151\40\150\303\263\141\x20\304\221\xc6\xa1\156\xa\x9\x9\x9\x9\11\11\11\x9\x9\x9\11\x9\74\x2f\x61\x3e\12\x9\11\11\x9\11\11\11\x9\11\x9\x9\74\x2f\154\x69\x3e"; } if ($this->permissions("\163\x61\x6c\x65\x73\137\145\x64\x69\x74")) { $str2 .= "\x3c\x6c\x69\76\xa\11\x9\x9\11\11\x9\11\x9\x9\x9\11\x9\x3c\x61\40\x74\151\x74\154\x65\x3d\x22\x55\160\144\x61\164\145\40\x52\145\x63\x6f\162\x64\40\77\x22\40\150\x72\145\x66\x3d\42" . $str1 . $sales->id . "\42\76\xa\x9\11\x9\11\x9\x9\x9\11\11\x9\x9\11\x9\x3c\x69\40\x63\x6c\x61\163\163\75\42\x66\x61\x20\x66\x61\55\146\x77\40\146\141\55\145\144\151\164\x20\x74\x65\x78\164\x2d\142\154\x75\145\x22\76\x3c\x2f\151\76\x53\341\273\255\141\12\x9\11\x9\x9\x9\x9\11\11\x9\11\x9\11\x3c\x2f\141\x3e\xa\x9\11\11\11\x9\x9\11\11\11\11\11\x3c\57\154\151\76"; } if ($this->permissions("\x73\x61\x6c\145\163\x5f\160\x61\171\x6d\145\x6e\x74\137\166\151\x65\167")) { $str2 .= "\74\x6c\x69\76\xa\x9\11\x9\x9\x9\11\11\11\x9\11\11\x9\74\141\x20\x74\151\164\154\x65\75\x22\x50\141\x79\42\40\x63\x6c\141\x73\x73\75\42\x70\x6f\151\156\164\x65\x72\x22\40\x6f\x6e\143\154\x69\143\153\75\42\x76\x69\x65\x77\x5f\160\x61\171\155\145\x6e\164\x73\50" . $sales->id . "\x29\42\40\76\12\11\x9\x9\11\x9\x9\x9\11\11\11\11\x9\x9\x3c\x69\x20\143\154\141\x73\x73\x3d\42\146\x61\40\146\x61\x2d\146\167\x20\x66\x61\55\x6d\157\x6e\x65\x79\40\164\x65\170\164\x2d\x62\x6c\x75\x65\x22\x3e\74\57\x69\76\x58\145\155\x20\154\xe1\xba\241\151\x20\x74\x68\141\x6e\150\x20\164\157\303\xa1\x6e\xa\11\x9\11\x9\11\x9\x9\11\11\11\x9\x9\x3c\x2f\x61\x3e\12\x9\x9\x9\x9\x9\11\11\11\11\11\11\x3c\57\154\x69\x3e"; } if ($this->permissions("\163\141\x6c\145\x73\137\x70\141\x79\155\x65\x6e\x74\x5f\x61\144\144")) { $str2 .= "\x3c\154\151\76\12\11\11\x9\11\x9\x9\x9\x9\x9\11\11\x9\74\x61\x20\x74\x69\164\154\x65\x3d\x22\x50\141\x79\42\40\x63\x6c\x61\x73\x73\75\x22\160\x6f\151\156\164\x65\x72\x22\40\157\156\143\x6c\151\x63\153\75\x22\160\141\x79\137\156\x6f\x77\50" . $sales->id . "\x29\42\40\76\12\11\11\x9\x9\11\x9\11\x9\11\x9\x9\x9\x9\x3c\151\40\143\x6c\x61\163\163\x3d\x22\146\141\x20\146\x61\x2d\x66\x77\40\x66\x61\55\x68\x6f\x75\x72\x67\x6c\x61\x73\163\55\x68\141\154\146\x20\164\145\x78\164\55\x62\x6c\165\145\x22\x3e\x3c\x2f\x69\76\x54\x68\x61\156\x68\x20\x74\x6f\303\241\x6e\x20\x6e\147\x61\x79\xa\11\x9\11\x9\11\x9\11\11\x9\x9\x9\x9\74\57\x61\76\xa\11\x9\x9\x9\x9\x9\x9\11\x9\11\11\74\x2f\x6c\x69\x3e"; } if ($this->permissions("\163\141\x6c\x65\163\137\x61\x64\x64") || $this->permissions("\163\x61\154\x65\163\137\145\144\x69\164")) { $str2 .= "\74\154\151\x3e\xa\11\11\x9\x9\11\11\x9\11\x9\11\x9\x9\74\141\x20\164\151\164\154\145\75\42\125\x70\144\141\x74\145\40\122\x65\x63\157\x72\144\40\77\x22\40\164\141\162\x67\x65\x74\x3d\42\137\x62\154\x61\156\x6b\x22\x20\x68\x72\145\x66\75\42\x73\141\154\145\x73\x2f\160\x72\151\x6e\x74\137\x69\x6e\x76\x6f\x69\x63\145\x2f" . $sales->id . "\42\x3e\xa\11\x9\x9\x9\11\11\x9\11\x9\11\x9\11\11\x3c\151\40\143\154\x61\163\x73\x3d\x22\146\x61\40\x66\141\x2d\146\167\40\x66\141\x2d\x70\x72\x69\156\164\x20\164\145\170\164\x2d\142\154\x75\145\x22\76\x3c\57\x69\x3e\x49\x6e\40\x68\xc3\xb3\x61\40\304\x91\306\241\156\x20\101\64\xa\11\11\11\11\x9\x9\x9\x9\x9\x9\11\x9\x3c\x2f\141\x3e\xa\x9\x9\x9\11\11\x9\11\11\x9\11\11\x3c\x2f\x6c\151\76\xa\xa\x9\x9\x9\11\x9\11\x9\11\11\12\11\x9\11\11\11\11\11\x9\x9\11\11\x3c\154\x69\x3e\12\11\11\x9\11\x9\x9\x9\x9\x9\x9\11\11\x3c\141\40\x73\164\171\154\145\75\x22\143\165\162\163\157\162\72\x70\x6f\151\x6e\164\145\x72\x22\x20\x74\x69\x74\154\145\75\42\x50\162\x69\x6e\x74\40\x50\117\x53\x20\x49\156\166\x6f\x69\143\x65\40\x3f\x22\x20\157\156\143\154\151\143\x6b\75\x22\x70\162\151\x6e\x74\137\151\x6e\x76\157\x69\143\x65\x28" . $sales->id . "\51\42\76\12\x9\x9\11\x9\11\11\x9\x9\11\x9\11\11\11\x3c\x69\x20\x63\x6c\x61\163\x73\x3d\42\146\x61\40\146\141\x2d\x66\167\40\146\141\55\x66\x69\154\145\55\164\x65\170\x74\x20\x74\145\170\x74\x2d\x62\x6c\x75\145\x22\76\x3c\57\x69\76\x49\x6e\40\150\xc3\263\141\40\304\221\306\xa1\x6e\x20\x50\x4f\123\12\11\x9\11\11\11\11\11\x9\11\x9\x9\x9\74\57\141\76\xa\x9\x9\11\x9\x9\11\11\11\11\x9\11\x3c\57\154\151\x3e"; } if (showBepPhaChe()) { $str2 .= "\12\x9\x9\11\11\74\154\x69\x3e\12\x9\x9\x9\11\x9\x9\x9\x9\11\x9\x9\x9\74\x61\x20\x74\151\x74\154\x65\75\x22\x55\160\144\x61\x74\x65\x20\122\x65\143\x6f\x72\144\40\x3f\42\x20\164\141\162\x67\145\164\x3d\x22\x5f\142\x6c\141\156\153\x22\40\150\x72\x65\146\75\x22\x73\141\x6c\145\x73\x2f\160\162\151\156\x74\137\164\145\155\x2f" . $sales->id . "\x22\76\12\11\x9\11\x9\11\x9\11\x9\11\x9\11\x9\x9\74\151\x20\143\x6c\141\x73\163\75\42\x66\x61\40\x66\141\55\146\167\x20\146\x61\55\160\162\151\x6e\164\x20\164\x65\170\x74\x2d\142\154\165\x65\x22\x3e\74\x2f\x69\x3e\x49\156\40\x74\145\x6d\40\x64\303\241\156\12\11\x9\x9\11\x9\11\x9\11\x9\x9\11\11\x3c\57\141\x3e"; } if ($sales->sales_status == "\106\151\156\x61\x6c" && $this->permissions("\x73\141\x6c\145\x73\x5f\162\145\164\x75\x72\x6e")) { $str2 .= "\x3c\154\151\x3e\xa\11\11\x9\x9\x9\11\11\x9\x9\x9\11\x9\x3c\x61\40\164\151\x74\154\x65\75\x22\x53\x61\154\145\163\x20\x52\x65\x74\165\x72\156\x22\x20\150\162\x65\146\x3d\x22\163\x61\x6c\x65\x73\x5f\x72\x65\164\165\162\156\x2f\141\144\x64\x2f" . $sales->id . "\42\76\12\11\x9\11\x9\11\11\x9\11\11\x9\11\11\11\x3c\151\x20\x63\154\x61\x73\x73\75\42\146\141\40\146\x61\x2d\x66\x77\x20\146\x61\55\x75\x6e\x64\157\40\164\x65\x78\x74\x2d\x62\x6c\165\x65\x22\x3e\x3c\57\151\76\124\x72\341\272\243\x20\x6c\341\272\241\x69\40\150\303\xa0\x6e\147\xa\11\11\x9\11\11\x9\x9\x9\x9\11\11\x9\74\57\141\x3e\12\11\x9\x9\11\11\11\11\x9\11\x9\x9\x3c\x2f\154\x69\76"; } if ($this->permissions("\x73\x61\154\x65\163\137\144\145\x6c\x65\x74\145")) { $str2 .= "\x3c\154\x69\76\12\11\x9\11\11\11\11\11\x9\11\x9\x9\11\x3c\141\40\x73\164\171\154\x65\75\42\143\x75\x72\x73\157\162\x3a\160\157\x69\156\164\x65\x72\x22\x20\x74\x69\164\154\x65\75\x22\x44\x65\x6c\145\164\x65\x20\x52\x65\x63\157\162\144\x20\77\x22\40\157\x6e\143\154\x69\143\x6b\75\42\144\145\154\x65\164\145\137\163\x61\x6c\x65\163\x28\47" . $sales->id . "\x27\x29\x22\x3e\12\11\11\x9\x9\11\x9\x9\11\x9\x9\x9\11\x9\x3c\x69\x20\x63\154\141\163\x73\75\x22\x66\141\x20\146\x61\x2d\146\x77\40\x66\x61\x2d\x74\162\141\163\150\40\x74\145\170\x74\x2d\162\145\x64\42\x3e\74\57\x69\76\x58\xc3\xb3\141\12\x9\11\11\x9\11\x9\x9\11\11\11\11\x9\x3c\57\x61\x3e\12\x9\11\x9\x9\x9\11\11\x9\x9\11\11\74\57\154\151\x3e\12\11\11\x9\x9\11\x9\11\x9\11\11\11\xa\11\x9\x9\11\11\11\11\x9\x9\11\x3c\x2f\x75\x6c\x3e\xa\x9\11\x9\11\11\11\x9\11\x9\74\57\144\x69\166\76"; } $row[] = $str2; $data[] = $row; } $output = array("\x64\162\x61\x77" => $_POST["\x64\x72\141\x77"], "\x72\x65\x63\157\x72\144\x73\124\157\x74\x61\x6c" => $this->sales->count_all(), "\162\x65\x63\x6f\162\144\x73\106\151\154\164\145\x72\145\x64" => $this->sales->count_filtered(), "\x64\x61\x74\x61" => $data); echo json_encode($output); } public function update_status() { $this->permission_check("\163\x61\154\x65\163\x5f\x65\x64\151\x74"); $id = $this->input->post("\151\x64"); $status = $this->input->post("\x73\x74\x61\164\x75\x73"); $result = $this->sales->update_status($id, $status); return $result; } public function delete_sales() { $this->permission_check_with_msg("\x73\x61\154\x65\x73\137\x64\145\x6c\x65\164\145"); $id = $this->input->post("\161\x5f\x69\144"); echo $this->sales->delete_sales($id); } public function multi_delete() { $this->permission_check_with_msg("\x73\141\x6c\x65\x73\137\144\145\x6c\x65\164\x65"); $ids = implode("\54", $_POST["\x63\x68\145\x63\153\142\157\x78"]); echo $this->sales->delete_sales($ids); } public function update_step() { $this->permission_check("\163\141\154\145\163\137\145\x64\151\x74"); $id = $this->input->post("\x69\144"); $status = $this->input->post("\163\x74\x61\164\165\x73"); $result = $this->sales->update_step($id, $status); return $result; } public function update_note() { $this->permission_check("\163\141\x6c\x65\163\137\145\x64\151\x74"); $id = $this->input->post("\151\x64"); $note = $this->input->post("\x6e\157\x74\145"); $result = $this->sales->update_note($id, $note); return $result; } public function search_item() { $q = $this->input->get("\x71"); $result = $this->sales->search_item($q); echo $result; } public function find_item_details() { $id = $this->input->post("\x69\x64"); $result = $this->sales->find_item_details($id); echo $result; } public function invoice($id) { if (!$this->permissions("\x73\141\154\x65\163\x5f\141\144\144") && !$this->permissions("\x73\x61\x6c\x65\163\137\x65\x64\151\x74")) { $this->show_access_denied_page(); } $data = $this->data; $data = array_merge($data, array("\x73\141\x6c\145\x73\x5f\x69\x64" => $id)); $data["\160\141\147\x65\x5f\164\x69\164\x6c\145"] = $this->lang->line("\163\141\154\145\163\137\x69\156\x76\157\151\x63\145"); $this->load->view("\x73\x61\x6c\55\x69\156\166\x6f\151\143\145", $data); } public function print_invoice($sales_id) { if (!$this->permissions("\x73\141\154\145\163\x5f\x61\144\x64") && !$this->permissions("\163\141\x6c\x65\x73\x5f\x65\x64\x69\164")) { $this->show_access_denied_page(); } $data = $this->data; $data = array_merge($data, array("\163\x61\154\x65\x73\x5f\151\144" => $sales_id)); $data["\x70\x61\147\x65\137\164\x69\x74\x6c\145"] = $this->lang->line("\163\x61\x6c\145\163\137\151\156\x76\x6f\x69\143\145"); $this->load->view("\160\162\151\x6e\164\55\163\x61\154\x65\163\55\x69\x6e\x76\x6f\x69\x63\x65\x2d\x32", $data); } public function print_tem($sales_id) { if (!$this->permissions("\163\x61\154\x65\163\x5f\x61\144\x64") && !$this->permissions("\163\x61\x6c\x65\163\137\x65\144\x69\x74")) { $this->show_access_denied_page(); } $data = $this->data; $data = array_merge($data, array("\163\x61\154\145\x73\137\151\x64" => $sales_id)); $data["\160\141\147\145\137\x74\x69\164\154\145"] = $this->lang->line("\x73\x61\x6c\x65\163\x5f\x69\x6e\x76\x6f\151\x63\145"); if (get_print_tem_type() == 1) { $this->load->view("\160\x72\x69\x6e\164\55\164\x65\x6d\55\64\60", $data); } else { if (get_print_tem_type() == 2) { $this->load->view("\x70\x72\151\x6e\164\55\164\145\x6d", $data); } } } public function print_invoice_pos($sales_id) { if (!$this->permissions("\163\141\154\x65\163\137\x61\x64\144") && !$this->permissions("\163\141\154\x65\x73\137\145\x64\x69\164")) { $this->show_access_denied_page(); } $data = $this->data; $data = array_merge($data, array("\x73\141\x6c\x65\x73\137\151\144" => $sales_id)); $data["\160\x61\147\145\137\x74\151\164\x6c\x65"] = $this->lang->line("\163\141\x6c\x65\163\x5f\151\156\x76\157\151\x63\x65"); $this->load->view("\163\141\x6c\x2d\x69\156\x76\157\151\143\145\x2d\x70\157\x73", $data); } public function pdf($sales_id) { if (!$this->permissions("\x73\141\154\145\163\137\x61\x64\144") && !$this->permissions("\x73\x61\x6c\145\163\x5f\145\x64\151\164")) { $this->show_access_denied_page(); } $this->load->model("\160\144\x66\137\x6d\x6f\144\x65\x6c"); $data = $this->data; $data["\160\x61\x67\145\137\164\151\164\154\145"] = $this->lang->line("\163\141\154\x65\163\x5f\151\x6e\166\x6f\x69\143\145"); $data = array_merge($data, array("\163\x61\154\x65\163\x5f\151\x64" => $sales_id)); $this->load->view("\160\162\x69\x6e\x74\x2d\x73\x61\154\145\x73\55\151\156\166\157\x69\143\145\x2d\62", $data); $html = $this->output->get_output(); $this->pdf_model->render($html, "\x53\141\x6c\145\x73\x20\x49\x6e\x76\157\x69\143\x65\x20\x2d\x20" . $sales_id); } public function return_row_with_data($rowcount, $item_id) { echo $this->sales->get_items_info($rowcount, $item_id); } public function return_sales_list($sales_id) { echo $this->sales->return_sales_list($sales_id); } public function delete_payment() { $this->permission_check_with_msg("\x73\141\x6c\145\x73\x5f\x70\x61\171\x6d\x65\156\x74\137\144\145\154\145\164\x65"); $payment_id = $this->input->post("\x70\141\171\x6d\145\156\x74\137\x69\x64"); echo $this->sales->delete_payment($payment_id); } public function show_pay_now_modal() { $this->permission_check_with_msg("\x73\x61\154\x65\163\137\166\151\145\167"); $sales_id = $this->input->post("\163\141\x6c\x65\x73\x5f\151\144"); echo $this->sales->show_pay_now_modal($sales_id); } public function save_payment() { $this->permission_check_with_msg("\163\x61\x6c\145\x73\137\141\x64\x64"); echo $this->sales->save_payment(); } public function view_payments_modal() { $this->permission_check_with_msg("\x73\x61\154\145\x73\137\166\x69\x65\167"); $sales_id = $this->input->post("\163\141\x6c\x65\x73\x5f\x69\x64"); echo $this->sales->view_payments_modal($sales_id); } public function view_sales_modal() { $this->permission_check_with_msg("\x73\141\x6c\145\163\x5f\x76\151\x65\x77"); $sales_id = $this->input->post("\x73\141\x6c\145\163\x5f\x69\144"); echo $this->sales->view_sales_modal($sales_id); } }