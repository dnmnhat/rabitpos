<?php
 defined("\102\101\x53\105\120\x41\124\110") or die("\x4e\x6f\40\144\151\x72\145\x63\x74\40\163\x63\x72\151\x70\164\40\141\x63\x63\145\163\x73\40\141\x6c\x6c\x6f\x77\x65\144"); class Cash_model extends CI_Model { var $table = "\144\142\x5f\x63\x61\163\150"; var $column_order = array(null, "\143\141\x73\x68\x5f\156\141\155\x65", "\x64\x65\x73\143\162\151\x70\164\151\157\156", "\x61\x6d\x6f\165\x6e\x74", "\163\x74\x61\164\x75\x73"); var $column_search = array("\x63\141\x73\150\x5f\x6e\141\x6d\x65", "\144\x65\x73\143\162\x69\160\x74\151\x6f\x6e", "\x61\155\x6f\165\156\164", "\163\164\141\164\x75\x73"); var $order = array("\x69\x64" => "\x65\x73\143"); private function _get_datatables_query() { $this->db->from($this->table); $i = 0; foreach ($this->column_search as $item) { if ($_POST["\163\x65\141\x72\x63\x68"]["\x76\x61\x6c\x75\145"]) { if ($i === 0) { $this->db->group_start(); $this->db->like($item, $_POST["\163\x65\x61\x72\143\x68"]["\166\x61\x6c\x75\x65"]); } else { $this->db->or_like($item, $_POST["\163\145\x61\x72\143\150"]["\166\141\154\165\145"]); } if (count($this->column_search) - 1 == $i) { $this->db->group_end(); } } $i++; } if (isset($_POST["\x6f\162\x64\x65\x72"])) { $this->db->order_by($this->column_order[$_POST["\157\x72\x64\145\x72"]["\60"]["\143\157\x6c\x75\x6d\156"]], $_POST["\157\x72\144\x65\x72"]["\60"]["\x64\x69\162"]); } else { if (isset($this->order)) { $order = $this->order; $this->db->order_by(key($order), $order[key($order)]); } } } function get_datatables() { $this->_get_datatables_query(); if ($_POST["\154\x65\x6e\x67\164\x68"] != -1) { $this->db->limit($_POST["\x6c\145\156\147\164\x68"], $_POST["\x73\x74\x61\x72\164"]); } $query = $this->db->get(); return $query->result(); } function count_filtered() { $this->_get_datatables_query(); $query = $this->db->get(); return $query->num_rows(); } public function count_all() { $this->db->from($this->table); return $this->db->count_all_results(); } public function get_details($id, $data) { $query = $this->db->query("\163\145\154\145\x63\x74\40\52\40\x66\x72\x6f\155\40\x64\142\x5f\143\x61\x73\150\40\x77\x68\x65\x72\145\40\x75\160\x70\145\x72\x28\151\144\x29\75\x75\160\160\145\x72\50\47{$id}\47\x29"); if ($query->num_rows() == 0) { show_404(); die; } else { $query = $query->row(); $data["\161\137\151\x64"] = $query->id; $data["\x63\x61\x73\150\137\x6e\x61\x6d\x65"] = $query->cash_name; $data["\144\145\x73\x63\x72\x69\x70\164\151\157\x6e"] = $query->description; $data["\141\155\157\x75\156\164"] = $query->amount; $data["\x73\x74\x61\164\x75\x73"] = $query->status; return $data; } } public function update_status($id, $status) { $query1 = "\165\x70\x64\x61\164\x65\40\144\x62\x5f\143\x61\x73\150\40\163\145\x74\40\163\164\x61\164\165\163\x3d\47{$status}\47\x20\167\x68\x65\162\145\x20\x69\144\75{$id}"; if ($this->db->simple_query($query1)) { echo "\163\x75\x63\x63\x65\163\163"; } else { echo "\146\x61\x69\154\145\x64"; } } public function update_amount($id, $amount) { $query2 = "\x75\160\x64\141\164\x65\40\x64\x62\x5f\x63\x61\x73\x68\x20\163\145\x74\x20\141\x6d\x6f\165\156\x74\x3d\40\50\x61\x6d\157\165\x6e\164\53\47{$amount}\47\x29\40\x77\x68\x65\x72\145\40\151\144\x3d{$id}"; if ($this->db->simple_query($query2)) { echo "\x73\165\x63\x63\x65\163\x73"; } else { echo "\146\x61\x69\154\145\144"; } } }