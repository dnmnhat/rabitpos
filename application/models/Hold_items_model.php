<?php
 defined("\x42\x41\123\x45\x50\101\x54\110") or die("\116\x6f\40\144\151\x72\145\143\x74\40\x73\x63\162\151\160\164\40\x61\143\x63\x65\163\x73\x20\141\154\154\157\167\145\x64"); class Hold_items_model extends CI_Model { var $table = "\144\142\137\150\x6f\154\144\x69\164\x65\155\x73"; var $column_order = array(null, "\151\164\x65\155\x5f\x69\144", "\150\x6f\x6c\x64\137\x69\x64", "\x73\164\x65\160"); var $column_search = array("\151\164\145\x6d\137\x69\144", "\150\157\154\144\x5f\x69\x64", "\x73\164\x65\160"); var $order = array("\x69\x64" => "\x65\x73\x63"); private function _get_datatables_query() { $this->db->from($this->table); $i = 0; foreach ($this->column_search as $item) { if ($_POST["\163\x65\141\x72\x63\x68"]["\166\x61\x6c\x75\145"]) { if ($i === 0) { $this->db->group_start(); $this->db->like($item, $_POST["\163\x65\141\x72\x63\150"]["\166\x61\154\165\145"]); } else { $this->db->or_like($item, $_POST["\163\x65\141\x72\143\x68"]["\x76\141\x6c\x75\145"]); } if (count($this->column_search) - 1 == $i) { $this->db->group_end(); } } $i++; } if (isset($_POST["\157\x72\144\x65\162"])) { $this->db->order_by($this->column_order[$_POST["\157\x72\144\x65\162"]["\x30"]["\x63\x6f\x6c\165\155\x6e"]], $_POST["\x6f\162\144\145\162"]["\x30"]["\144\x69\162"]); } else { if (isset($this->order)) { $order = $this->order; $this->db->order_by(key($order), $order[key($order)]); } } } function get_datatables() { $this->_get_datatables_query(); if ($_POST["\154\x65\x6e\147\x74\x68"] != -1) { $this->db->limit($_POST["\154\145\x6e\147\164\x68"], $_POST["\x73\x74\141\x72\x74"]); } $query = $this->db->get(); return $query->result(); } function count_filtered() { $this->_get_datatables_query(); $query = $this->db->get(); return $query->num_rows(); } public function count_all() { $this->db->from($this->table); return $this->db->count_all_results(); } public function get_details($id, $data) { $query = $this->db->query("\x73\145\154\145\143\x74\x20\52\x20\146\162\x6f\155\x20\x64\142\137\150\157\x6c\144\151\x74\x65\155\163\40\167\150\x65\162\x65\40\165\160\x70\145\x72\x28\x69\x64\x29\75\165\160\x70\145\x72\50\x27{$id}\x27\51"); if ($query->num_rows() == 0) { show_404(); die; } else { $query = $query->row(); $data["\x71\137\151\144"] = $query->id; $data["\x63\141\163\150\x5f\x6e\x61\x6d\x65"] = $query->hold_id; $data["\x64\x65\x73\x63\x72\x69\160\x74\151\157\156"] = $query->description; $data["\x61\x6d\x6f\165\156\164"] = $query->total_cost; $data["\x73\164\x61\164\x75\163"] = $query->step; return $data; } } public function update_status($id, $status) { $query1 = "\165\x70\144\x61\x74\x65\x20\144\x62\137\x63\141\163\x68\x20\163\x65\164\x20\x73\x74\141\x74\165\x73\75\x27{$status}\47\x20\x77\x68\145\x72\x65\x20\151\x64\x3d{$id}"; if ($this->db->simple_query($query1)) { echo "\163\x75\143\143\x65\x73\x73"; } else { echo "\146\141\x69\x6c\145\144"; } } public function update_amount($id, $amount) { $query2 = "\165\160\x64\141\x74\x65\x20\144\x62\137\x63\x61\163\x68\x20\163\145\164\40\x61\155\x6f\x75\x6e\x74\x3d\x20\x28\x61\155\x6f\165\156\164\x2b\x27{$amount}\47\51\x20\167\x68\145\162\145\40\151\144\75{$id}"; if ($this->db->simple_query($query2)) { echo "\163\x75\143\x63\145\x73\163"; } else { echo "\146\x61\x69\154\x65\x64"; } } }